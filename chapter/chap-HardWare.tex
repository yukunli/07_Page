\chapter{水分测量系统的硬件设计}\label{chap4}

本章主要围绕构成水分测量系统的硬件设计进行介绍。硬件电路主要包括~LED~光源的激励驱动信号的产生、模拟信号输入通道的设计、A/D~ 采集电路以及主控~DSP~控制器等部分。

\section{硬件系统总体设计}

本课题设计的水分测量系统主要由以下四部分组成：光源激励模块、信号处理模块、DSP~控制模块以及电源电路模块。其中信号处理模块由模拟信号处理模块和数字锁相放大器组成，数字锁相放大器由~DSP~微控制内部实现，所以硬件电路的实现上，信号处理模块主要是指模拟信号处理。硬件电路设计的主要功能是为~LED~光源提供激励信号，并对光电探测器接收到的电信号进行放大、滤波、采集等数据处理，并将采集到的信号传送到微控制器进行后续数据处理。硬件系统的整体结构框图如图~\ref{fig40}~所示
\begin{figure*}[!h]
\centering
\includegraphics[width=12cm]{fig40.pdf}
\caption {硬件电路总体框图}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig40}The overall block diagram of the hardware circuit}
\end{figure*}

下面将对以上各模块的工作过程做简单的阐述：

（1）光源激励模块

该模块为~LED~光源提供正弦波激励信号，使~LED~光源能以固定频率的正弦激励照射到被测物的表面。标准的正弦波激励信号由~DSP~微处理器控制数字式频率合成器（DDS）芯片产生，再经过恒流源电路变成正弦电流激励供给~LED~光源。由于本课题采用了三波长测量手段，即一路测量波长和两路参比波长的光源同时照射被测物的表面，所以本文的光源激励硬件模块需要三路，分别给三路不同波长的光源提供同幅不同频的正弦波电流激励信号，本课题中三路激励信号的频率一次为~5kHz~、6kHz~和~7kHz。

（2）模拟信号处理模块

模拟信号处理电路包括信号放大电路和带通滤波电路。其中信号放大电路由两部分组成：低噪声前置放大器和次级放大器。从被测物表面反射回来的三路不同频率的光信号全部进入光电探测器后转化为电信号，但此时的有用信号非常微弱。为了得到满足后续~A/D~采样的电平范围要求，微弱的信号经过低噪声前置放大器和次级放大器进行信号放大，放大后的信号是三路不同频率正弦信号的叠加，再分别经过三路不同中心频率的窄带带通滤波器进行滤波，就得到了三路分离后的正弦波待测信号。本课题中这三路待测信号的频率依次为~5kHz~、6kHz~和~7kHz，与提供的三路~LED~光源激励信号的频率相一致。将这三路待测信号全部通过~A/D~转换芯片进行模数转换后送入~DSP~微处理器，在~DSP~微处理器内部进行数字锁相放大器运算。所以该模块也是数字锁相放大器的信号输入通道。

（3）DSP~控制模块

DSP~微处理器是整个水分测量系统的控制核心，它不仅控制~DDS~芯片产生所需的正弦波信号，同时用于产生数字锁相放大器所需的参考信号序列，并与三路待测信号依次进行数字锁相放大器运算，从而得到待测信号的幅值，进一步计算得到被测物的水分含量。DSP~控制模块还包括~PC~通讯接口电路、蜂鸣器及~LED~指示电路、温控电路和工业串口屏接口电路。其中，PC~通讯接口电路和工业串口屏接口电路均采用串口通信原理，用于将测量得到的数据实时传输到上位机进行显示和存储。

（4）电源电路模块

电源模块用于给硬件电路的不同模块提供稳定的电源，模拟部分主要是给恒流源、运算放大器等器件供电，数字部分主要是给~DSP~微处理器、DDS~芯片等数字器件供电。本课题根据模拟部分和数字部分的供电需求，设计了输出稳定、低纹波、低噪声的不同输出电压的电源。
\section{硬件系统的基础性设计}

\subsection{系统电源设计}
电源电路的设计是水分检测系统的重要部分，电源的性能影响着水分仪的稳定性和准确度。因此设计并制作高可靠性、高效率、低纹波的电源是十分必要的。根据表~\ref{ht1}~所示的硬件电路供电需求，本课题设计了独立的电源电路板给整个系统供电，用以减少板级间电源的相互影响。
\begin{table*}[!h]\tiny
\caption{硬件电路电源需求}
\addtocounter{table}{-1}
\renewcommand\tablename{Table}
\caption{Hardware circuit power demand}
\label{ht1}
\footnotesize
%\setlength\tabcolsep{2.8pt}
\renewcommand{\arraystretch}{1.5}
\centering
\begin{tabular}{ccccccccccccccccccccccccccccccccccccccc}
\\
\bottomrule
~~电源类型~~   && ~~~电源电压~~~ && ~供电单元~  && ~参数需求~   \\
\hline
\multirow{5}{*}{模拟} &&      $+$15V    && 3~路恒流源电路 &&纹波小，电流较大，功率$>9W$\\
                      &&      $\pm$12V  && ~运算放大器，A/D~芯片等模拟电路~&& ~~纹波小，噪声低，功率$>9.5W$~~\\
                      &&      $+$5V     && 波形发生器，线性稳压芯片&&纹波小，电流大，功率$>5W$ \\
                      &&      $+$3.3V   && DSP~控制器模拟电源      && \multirow{2}{*}{电压稳定，功率很小} \\
                      &&      $+$1.9V   && DSP~控制器模拟电源       \\
\multirow{3}{*}{数字} &&      $+$5V     && 有源晶振、电平转换等数字芯片 &&\multirow{3}{*}{电压稳定，功率很小}\\
                      &&      $+$3.3V   && DSP~控制器数字电源、测温电路等数字电路 \\
                      &&      $+$1.9V   && DSP~控制器数字电源\\
\bottomrule
\end{tabular}
\end{table*}

为了简化电源电路实际的复杂性，本课题选用了金升阳的~LH~系列~AC-DC~模块电源，LH~系列电源模块输入电压范围为~85～264VAC，50/60Hz，输出电源稳定、低纹波、低噪声，具有输出短路、过流和过温保护功能。该系列的电源模块只需要几个电容电阻就能实现~AC-DC~的精确输出，各输出电压的功率也能满足本课题的要求。

其中，$+$15V~电源由型号为~LH10-B15~电源模块产生，输出功率能达到~10W。 而~$\pm$12V~电源由型号为~LH10-10A12~电源模块产生，输出功率能达到~10W，模拟部分的~$+$5V~电源由型号为~LH05-10B05~电源模块产生，输出功率也能达到~5W，完全能满足本课题的供电需求。其余的电源电压，如数字部分的~$+$5V~电源、模拟及数字部分的~$+$3.3V、$+$1.9V~电源均由模拟部分的~$+$5V~电源通过电感器件和线性稳压电源芯片转化而来。
\begin{figure*}[!h]
\centering
\includegraphics[width=14cm]{fig41.jpg}
\caption {LH10-10A12~电源模块电路图}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig41}The power supply circuit diagram about LH10-10A12}
\end{figure*}

本文以~LH10-10A12~电源模块的电路原理图为例进行说明（如图~\ref{fig41}），其他电源模块的电路原理图类似。图中~F1~为保险丝管，对电路具有过流保护的作用。U1~为电源模块，U2~是型号为~FC-LX1D~的~EMI~滤波模块，通过在电源模块的输入端安装~EMI~滤波模块，可以提高仪器的抗电磁干扰能力，减少外界对近红外水分仪的干扰，保障水分仪的正常工作\upcite{26}。
D1、D2~为瞬变电压抑制二极管，它是一种高性能的电路保护器件，具有承受瞬间大电流的能力，当电路中有瞬变电压发生时，瞬变电压抑制二极管能够快速响应，耗散很大的瞬变电流，使电路电压箝位于低电压上，从而保护后面的电路。

本课题中数字电路的核心是主控芯片~TMS32F28335~处理器。为满足该~DSP~芯片内部功能模块的不同供电需求，设计了幅值为~3.3V~和~1.9V~ 的数字电源和模拟电源两种。数字电源电路采用了~DSP~专用电源芯片~PS767D301，能够同时输出两种电压，一路固定输出~3.3V，一路可以在~1.5V-5.5V~范围内调整。
\begin{figure*}[!h]
\centering
\includegraphics[width=14cm]{fig42.jpg}
\caption {3.3V和1.9V电源电路图}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig42} The 3.3V and 1.9V power supply circuit}
\end{figure*}

3.3V~和1.9V~电源电路原理如图~\ref{fig42}~所示。两个输入端均接入数字部分的~5V~电压，第~2~路输出的电压为~3.3V，第一路输出的电压通过电阻~R42~ 和~R43~分压反馈到~24~引脚，使得输出电压稳定在~1.9V，这样便得到数字电源~3.3V~和~1.9V。再分别通过电感~L44~和~L45~得到模拟电源~3.3V~和~1.9V。C44$-$C51~均为滤波电容，0.1$\mu$F~电容可以滤除高频干扰，22$\mu$F~电容可以滤除低频干扰，使得电源能够稳定输出。

\subsection{DSP最小系统设计}

为了提高系统的处理速度，处理精度以及满足本系统要求的高速数字信号处理，本课题选用由~TI~公司推出的一款浮点型数字信号处理器~TMS320F28335DSP。

TMS320F000~系列~DSP~融合了控制外设的集成功能与微处理器（MCU）的易用性，具有强大的控制和信号处理能力以及~C~语言编程效率。TMS320F28335~是在已有的~DSP~平台上增加了浮点运算内核，能执行复杂的浮点运算，可以节省代码执行时间和存储空间，具有精度高、成本低、功耗小、外设集成度高、数据和程序存储量大等优点，可以为嵌入式工业应用提供更加优秀的性能和更加高效的软件设计。TMS320F28335~的主要特点总结如下：

（1）高性能静态~CMOS~技术：主频可达~150MHz,指令周期为~6.67ns；内核电压为~1.9V，I/O~硬件电压为3.3V。

（2）高性能的~32~位~CPU~：具有单精度浮点运算单元（FPU），$16\times16$~位和~$32\times32$~位乘法累加操作，两个~$16\times 16$~ 位乘法累加器。能够快速执行中断响应，具有统一的寄存器编程模式。

（3）哈佛流水线总线结构：程序存储器和数据存储器互相独立，可进行独立编址和访问。并允许数据在程序空间和数据空间互相传送。可用

（4）片内存储：$256K\times16$~的~Flash~存储器，$34K\times16$~的~SARAM，以及~$1K\times16$~的~OPT~（一次性可编程）~ROM。

（5）先进的仿真功能：支持~JTAG~实时在线仿真和边界扫描，具有分析和断点功能，能够硬件实时调试。

TMS320F28335~能够运行的最小系统包括以下几个部分：电源电路、晶振电路、JTAG~接口电路、看门狗及复位电路等构成。系统框图如图~\ref{fig43}~ 所示。
\begin{figure*}[!h]
\centering
\includegraphics[width=10cm]{fig43.pdf}
\caption {TMS320F28335最小系统框图}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig43} The minimum system block diagram on TMS320F28335}
\end{figure*}

其中，3.3V~和~1.9V~电源电路在上一小结中已经介绍过，采用~TI~公司专用的~LDO~芯片即获得了满足微控制器双电压供电和功耗的要求的输出电压。本课题采用~30MHz~晶振提供系统时钟，可获得最高~150MHz~的~CPU~主频。JTAG~接口电路、看门狗及复位电路采用经典的电路连接方式，在此不再赘述。

\subsection{串口通信设计}

本课题设计了两路~RS232~串口通信接口，分别与上位机和工业触摸屏进行实时的数据交换。PC~上位机用于远端接收水分检测系统传输回来的历史数据，并在上位机软件进行显示和存储。工业触摸屏用于工业现场的实时水分数据的显示、水分测量系统的标定以及较正操作。

TMS320F28335DSP~芯片内部有三个全双工~UART~通讯接口，因此可以使用其中的两个来分别与上位机和工业触摸屏进行通信。通信电路如图~\ref{fig44}~所示，使用~MAX3232~芯片完成~TTL~电平与~RS232~电平的转换\upcite{}。01~通道连接工业触摸屏，02~通道连接上位机进行串口通信。
\begin{figure*}[!h]
\centering
\includegraphics[width=13cm]{fig44.jpg}
\caption {通信电路}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig44} The communication circuit}
\end{figure*}

\section{光源信号驱动电路设计}

光源驱动电路为近红外~LED~光源提供精密稳定按正弦规律变化的驱动电流，LED~光源的工作电压低，效率高。驱动电流过大会损坏电源，过低又会降低光源发出的光强。驱动电路不稳定也会影响到水分仪的测量精度，因此光源驱动电路的设计对整体系统的实现至关重要。
\subsection{激励信号发生器}

本课题三路光源分别采用~5kHz、6kHz~和~7kHz~频率的正弦信号调制。光电传感器检测到的信号经过电路中不同窄带通滤波器得到三路不同的信号。电路中的正弦激励信号是由~AD9833~信号发生器芯片产生的，AD9833~是~ADI~公司生产的一款低功耗、可编程波形发生器，能够产生正弦波、三角波、方波输出。波形发生器广泛应用于各种测量、激励和时域响应领域。AD9833~的输出频率和相位都可通过软件编程设置，易于调节。主频时钟为~25MHz~ 时，精度为~0.1Hz；主频时钟为~1MHz~时，精度可以达到~0.004Hz。

AD9833~是一块完全集成的~DDS~电路，仅需要一个外部参考时钟，一个低精度电阻器和一个解耦电容器就能产生高达~12.5MHz~的波形输出。其硬件电路如图~\ref{fig45}~所示。
\begin{figure*}[!h]
\centering
\includegraphics[width=14cm]{fig45.jpg}
\caption {正弦波发生器电路}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig45} Sine wave generator circuit}
\end{figure*}

DSP~微控制器通过三线制~SCI~通信方式对~AD9833~的输出频率进行控制，其外部参考时钟由频率为~1MHz~的有源晶振生产。AD9833~的输出信号的峰峰值的典型值为~0.6V~，而且是双极性波形，不能满足驱动后续恒流源电路的设计要求，所以在~AD9833~的波形输出端设计了一个~RC~ 低通滤波器，将双极性波形转换为单极性波形。

由于本课题需要的三种不同频率的正弦激励信号，而每路正弦波发生电路只能产生一种固定频率的正弦信号，所以在硬件电路的实际上，本课题分别设计了三路相对独立的正弦波发生电路用来输出不同频率的周期信号。其中，三路~AD9833~共用同一个外部有源晶振以及~SCI~的数据线和时钟线接口，DSP~通过控制~AD9833~的片选信号线对三路~AD9833~进行选通。同样的道理，三路~AD9833~的波形输出也将分别独立的进入到后续的信号放大电路和恒流源电路中。

\subsection{恒流源驱动电路}
LED~光源具有单向导电性、具有势垒电势和温度系数为负等特性，LED~光源在正向导通后，其正向电压的细小变化将引起~LED~电流的很大变化\cite{29}。近红外~LED~光源具有同普通~LED~光源相似的性质，过大电流以及反向电流都会造成近红外~LED~光源的损坏，因此恒流源电路的设计要考虑瞬变的大电流、反向电压和静电等会损坏光源的情况。

在激励驱动电路系统中，恒流源提供~$0\sim200mA$~的正弦变化的激励电流，恒流源的精度和稳定性影响着整个系统的精度和稳定。本课题设计的恒流源电路如图~\ref{fig46}~所示。
\begin{figure*}[!h]
\centering
\includegraphics[width=14cm]{fig46.jpg}
\caption {恒流源电路}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig46} The constant current source circuit}
\end{figure*}

波形发生器输出的正弦信号经过信号放大电路后输入恒流源电路的~SOUR$_{-}$IN1~端口，通过压控流型恒流源电路达到控制~RJ1~电阻两端的电压的目的。RJ1~采用低温漂、高精度的绕线电阻~RX70~,当~RJ1~电阻两端的电压是正弦变化的电压时，流经~RJ1~电阻的电流就是正弦变化的激励电流。由于流过达林顿晶体管~Q2~集电极的电流等于发射极的电流，所以该电流便是提供给~LED~光源的正弦驱动电流。Q1~为场效应管，通过控制场效应管~G~和~S~两端的电压，实现控制电路的导通和关断，电路上电时，G~和~S~两端的电压由电容逐渐充电来控制，从而可以缓慢控制场效应管由关断到导通状态，实现了慢启动功能。D3~为瞬态电压抑制二极管，它是一种保护光源的器件，用来防止浪涌电压对光源的损坏。

\begin{figure*}[!h]
\centering
\includegraphics[width=7cm]{fig47.jpg}
\caption {恒流源电路等效模型}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig47} Equivalent model of constant current source circuit}
\end{figure*}

在压控恒流源的设计中，精密电阻和限流电阻的取值非常关键，如果电阻的取值不当会造成电流信号失真的情况。本课题将恒流源电路简化成如图~\ref{fig47}~所示的等效模型进行分析。这个电路是实质是一个负反馈电路，通过~R~的电流为~$I_{R}$，其端电压为~$U_{b}$~，流过~$R_{L}$~和~$R_{o}$~电路为~$I_{R_{L}}$，由运放两输入端“虚短”关系有：
\begin{equation}\label{xd1}
  U_{IN}=U_{+}=U_{-} = U_{b}
\end{equation}
\begin{equation}\label{xd2}
  I_{R_{L}}=I_{R}=\frac{U_{b}}{R}
\end{equation}

由式~\ref{xd1}~和式~\ref{xd2}~可知，通过电阻~$R$~的电流受~$U_{IN}$~的控制。但是在负载通路上又必须要满足欧姆定律，关系式为：
\begin{equation}\label{xd3}
  V_{CC}=I_{R_{L}}R_{o}+I_{R_{L}}R_{L}+U_{b}
\end{equation}

由于三极管在导通状态下内阻很小，其上消耗的电压忽略不计。

将式~\ref{xd2}~代入上式中，得：
\begin{equation}\label{xd4}
  V_{CC}=U_{IN}(\frac{R_{o}+R_{L}}{R}+1)
\end{equation}

本课题中恒流源电路的输入是幅值为~$0\sim$4V~正弦变化的电压信号，而驱动~LED~光源的信号是幅值为~$0\sim200$mA~正弦变化的电流，所以精密电阻~$R$~取值~$20\Omega$。LED~光源在一定驱动电流下阻值约为~$24\Omega$，考虑到恒流源电路电源~$V_{CC}$~为~15V，所以电阻~$R_{o}$~取值~$40\Omega$~是比较合适的。

\section{模拟信号输入通道设计}
光信号的变化引起PbS探测器的阻值的变化，经过偏置和前置放大电路转变成电信号，并进行一定的放大。微弱的电信号依次经过各种模拟信号处理电路的处理后，最终进入单片机AD通道进行采样。模拟信号处理电路的框图如图4.7所示。

\subsection{信号放大电路}
ha
\subsection{窄带带通滤波电路}
ha
\section{模数转换电路设计}

\subsection{A/D~芯片选型}

为了实现对多路~AD~信号实时高精度采集，以及考虑到模拟信号双极性特点，本课题采用了亚德诺半导体公司（~ADI~）推出的一款六通道逐次逼近型（~SAR~）的模数转换器~AD7656。AD7656~内置六个~16~位、快速、低功耗逐次逼近型~ADC，并集成到一个封装中，采用~iCMOS~ 工艺（工业级~CMOS~）设计。采用iCMOS~工艺设计的元件不但可以输入双极性信号，同时还能提升性能，大幅降低功耗并减小封装尺寸。

AD7656~主要有以下几个特点：

（1）供电电源电压范围较宽，可通过配置选择模拟量输入电压范围：$\pm$10V、$\pm$5V。

（2）吞吐速率最高可达~250kSPS，并且内置宽带宽（~4.5 MHz~）采样保持放大器，可处理最高~4.5MHz~ 的输入频率。

（3）片内包含一个~2.5V~内部基准电压源和基准缓冲器。

（4）~AD7656~ 还具有高速并行和串行接口，可以与微处理器（~MCU~）或数字信号处理器（~DSP~）连接。

（5）AD7656~ 在串行接口方式下，能提供一个菊花链连接方式，以便把多个~ADC~ 连接到一个串行接口上。

\subsection{芯片原理和结构}

AD7656~是逐次逼近型AD转换器，每路~ADC~电路包括一个采样保持器、一个比较器、一个~SAR~模数转换器和一个逻辑控制单元。具体结构如图~\ref{fig48}~所示。
\begin{figure*}[!h]
\centering
\includegraphics[width=12cm]{fig48.jpg}
\caption {AD7656~内部结构框图}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig48} Internal structure diagram of AD7656 }
\end{figure*}

AD7656~的6路模拟信号输入通道都是相关独立的，外部模拟信号从~V1$-$V6~引脚输入，经过一个高带宽的线性跟随器（~T/H~）单元进行采样。每路~ADC~均按照逐次逼近原理进行，由控制逻辑电路和~SAR~模数转换器共同完成。当模拟信号转换为数字信号后，由控制逻辑单元控制数字输出驱动电路以串行或并行数据的方式输出。

AD7656~的模拟信号输入采取了单端输入方式，输入信号的电平范围为两种~$\pm$10V~和~$\pm$5V。可通过两种方式选择输入信号电平范围，硬件上通过~RANGE~管脚设置，软件上通过配置控制寄存器的~RANGE~位来选择。AD7656~的转换分辨率与输入信号的范围有关，当输入信号的电平范围为~$\pm$5V~时，ADC~分辨率能达到~0.153mV。

\subsection{A/D~前端调理电路设计}
为了使从模拟信号处理通道输出的信号源与~AD7656~要求的输入信号相匹配，本课题对信号源的信号进行前端调理电路调整，在~AD7656~前端的调理电路中加入了阻抗匹配和抗混叠滤波电路。
\begin{figure*}[!h]
\centering
\includegraphics[width=12cm]{fig50.png}
\caption {AD7656~前端调理电路}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig50} The front conditioning circuit of AD7656 }
\end{figure*}

AD7656~的输入端很可能对信号源信号分压，从而影响采集转换信号的精度，所以设计阻抗匹配电路是非常必要的。在~AD7656~前级输入加入由运算放大器构成的电压跟随器很够获得较低的输出阻抗，从而驱动~AD7656~的输入端，电路原理如图~\ref{fig50}~所示。AD7656~输入端具有容性负载特性，通常需要一个电阻和电容组成外部补偿电路用以减少容性负载的影响。同时，电阻和电容还可以做低通滤波器，实现抗混叠滤波电路的效果。

\subsection{A/D~与~DSP~接口电路设计}

AD7656~与~TMS320F28335~控制器接口电路采取并行接口设计，接口电路如图~\ref{fig49}~所示。
\begin{figure*}[!h]
\centering
\includegraphics[width=14cm]{fig49.jpg}
\caption {AD7656~与~DSP~接口电路}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig49} Interface circuit of AD7656 and DSP }
\end{figure*}


在电路设计时，AD7656~器件具有八个~$AVcc$~电源引脚，每个~$AVcc$~电源引脚均需要通过一个~10$\mu$F~钽电容和一个~100nF~陶瓷电容进行良好去耦。AD7656~即可采用内部基准电压源工作，也可以采用外部施加的基准电压源工作。在本电路中，器件被配置为在内部基准电压源下工作。

当~AD7656~的~H/SSEL~管脚接地时，AD7656~在硬件选择模式下工作，可以根据硬件选择引脚上的逻辑电平来配置~AD7656。本电路中在硬件选择模式下将~AD7656~的~SER/PAR~管脚接地使~AD7656~工作在并行接口方式。同时，将~RANGE~管脚接地从而选择~$\pm$5V~的模拟输入范围。而控制转换启动的~CONVST~A、~CONVST~B~和~CONVST~C~管脚接入~DSP~控制器，由~DSP~通过软件激活~CONVST~输入从而启动~AD7656~的转换。CONVST~A~用来对~V1~和~V2~启动同步采样，CONVST~B~用来对~V3~和~V4~启动同步采样，而~CONVST~C~用来对~V5~和~V6~启动同步采样。本课题只使用了前三路模拟输入通道，其余模拟输入通道接地。


\section{温控电路设计}

\subsection{温度检测电路}
在水分测量仪工作时，环境温度对仪器工作具有一定的影响，光电探测器和近红外~LED~光源在不同温度下工作的特性也不一样，因此实时检测环境温度是十分必要的。本课题采用~DS18B20~温度传感器，它具有微型化、低功耗、抗干扰能力强，易与微处理器接口等优点，它集温度测量、A/D~转换于一体，只需一根端口线就能与单片机通讯，测量系统电路简单，易于实现。其测温范围为~-55℃$\sim$~+125℃，测温分辨率为~0.5℃。 温度测量电路如图~\ref{fig51}~所示。
\begin{figure*}[!h]
\centering
\includegraphics[width=10cm]{fig51.png}
\caption {测温电路}
\addtocounter{figure}{-1}
\renewcommand\figurename{Fig.}
\caption{\label{fig51} The temperature measurement circuit }
\end{figure*}

\subsection{半导体制冷电路}

\section{本章小结}












